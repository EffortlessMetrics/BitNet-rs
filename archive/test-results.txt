   Compiling bitnet-models v0.1.0 (/home/steven/code/Rust/BitNet-rs/crates/bitnet-models)
   Compiling bitnet v0.1.0 (/home/steven/code/Rust/BitNet-rs)
warning: bitnet-sys@0.1.0: bitnet-sys: 'ffi' feature not enabled; skipping native build
   Compiling bitnet-common v0.1.0 (/home/steven/code/Rust/BitNet-rs/crates/bitnet-common)
warning: unnecessary `unsafe` block
   --> crates/bitnet-common/tests/integration_tests.rs:130:5
    |
130 |     unsafe { unsafe { env::set_var("BITNET_TEMPERATURE", "0.9"); } }
    |     ^^^^^^ unnecessary `unsafe` block
    |
    = note: `#[warn(unused_unsafe)]` on by default

warning: unnecessary `unsafe` block
   --> crates/bitnet-common/tests/integration_tests.rs:131:5
    |
131 |     unsafe { unsafe { env::set_var("BITNET_USE_GPU", "true"); } }
    |     ^^^^^^ unnecessary `unsafe` block

warning: unnecessary `unsafe` block
   --> crates/bitnet-common/tests/integration_tests.rs:140:5
    |
140 |     unsafe { unsafe { env::remove_var("BITNET_TEMPERATURE"); } }
    |     ^^^^^^ unnecessary `unsafe` block

warning: unnecessary `unsafe` block
   --> crates/bitnet-common/tests/integration_tests.rs:141:5
    |
141 |     unsafe { unsafe { env::remove_var("BITNET_USE_GPU"); } }
    |     ^^^^^^ unnecessary `unsafe` block

warning: variable does not need to be mutable
   --> crates/bitnet-models/src/transformer.rs:475:13
    |
475 |         let mut hidden = self.embed(&ids_vec)?;
    |             ----^^^^^^
    |             |
    |             help: remove this `mut`
    |
    = note: `#[warn(unused_mut)]` on by default

warning: function `pick` is never used
  --> crates/bitnet-models/src/weight_mapper.rs:43:4
   |
43 | fn pick<'a>(tensors: &'a HashMap<String, Tensor>, candidates: &[&str]) -> Option<&'a Tensor> {
   |    ^^^^
   |
   = note: `#[warn(dead_code)]` on by default

warning: `bitnet-models` (lib) generated 2 warnings (run `cargo fix --lib -p bitnet-models` to apply 1 suggestion)
   Compiling bitnet-tokenizers v0.1.0 (/home/steven/code/Rust/BitNet-rs/crates/bitnet-tokenizers)
warning: unreachable statement
  --> crates/bitnet-tokenizers/src/loader.rs:65:13
   |
63 |         return Err(anyhow::anyhow!("SentencePiece support not compiled in. Enable the 'spm' feature."));
   |         ----------------------------------------------------------------------------------------------- any code following this expression is unreachable
64 |             #[cfg(not(feature = "spm"))]
65 |             return Err(anyhow::anyhow!("SentencePiece support not compiled in. Enable the 'spm' feature."));
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ unreachable statement
   |
   = note: `#[warn(unreachable_code)]` on by default

warning: unreachable statement
  --> crates/bitnet-tokenizers/src/loader.rs:86:13
   |
84 |         return Err(anyhow::anyhow!("SentencePiece support not compiled in. Enable the 'spm' feature."));
   |         ----------------------------------------------------------------------------------------------- any code following this expression is unreachable
85 |             #[cfg(not(feature = "spm"))]
86 |             return Err(anyhow::anyhow!("SentencePiece support not compiled in. Enable the 'spm' feature."));
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ unreachable statement

warning: unused variable: `bytes`
  --> crates/bitnet-tokenizers/src/loader.rs:50:17
   |
50 |             let bytes = base64::engine::general_purpose::STANDARD.decode(blob_str)?;
   |                 ^^^^^ help: if this is intentional, prefix it with an underscore: `_bytes`
   |
   = note: `#[warn(unused_variables)]` on by default

warning: unused variable: `bos`
  --> crates/bitnet-tokenizers/src/loader.rs:52:17
   |
52 |             let bos = metadata.get("tokenizer.ggml.bos_token_id")
   |                 ^^^ help: if this is intentional, prefix it with an underscore: `_bos`

warning: unused variable: `eos`
  --> crates/bitnet-tokenizers/src/loader.rs:55:17
   |
55 |             let eos = metadata.get("tokenizer.ggml.eos_token_id")
   |                 ^^^ help: if this is intentional, prefix it with an underscore: `_eos`

warning: unused variable: `bytes`
  --> crates/bitnet-tokenizers/src/loader.rs:68:17
   |
68 |             let bytes: Vec<u8> = blob_array
   |                 ^^^^^ help: if this is intentional, prefix it with an underscore: `_bytes`

warning: unused variable: `bos`
  --> crates/bitnet-tokenizers/src/loader.rs:73:17
   |
73 |             let bos = metadata.get("tokenizer.ggml.bos_token_id")
   |                 ^^^ help: if this is intentional, prefix it with an underscore: `_bos`

warning: unused variable: `eos`
  --> crates/bitnet-tokenizers/src/loader.rs:76:17
   |
76 |             let eos = metadata.get("tokenizer.ggml.eos_token_id")
   |                 ^^^ help: if this is intentional, prefix it with an underscore: `_eos`

warning: unused variable: `bytes`
  --> crates/bitnet-tokenizers/src/loader.rs:97:17
   |
97 |     if let Some(bytes) = reader.get_bin_or_u8_array("tokenizer.ggml.model") {
   |                 ^^^^^ help: if this is intentional, prefix it with an underscore: `_bytes`

warning: unused variable: `bos`
  --> crates/bitnet-tokenizers/src/loader.rs:99:13
   |
99 |         let bos = reader.get_u32_metadata("tokenizer.ggml.bos_token_id");
   |             ^^^ help: if this is intentional, prefix it with an underscore: `_bos`

warning: unused variable: `eos`
   --> crates/bitnet-tokenizers/src/loader.rs:100:13
    |
100 |         let eos = reader.get_u32_metadata("tokenizer.ggml.eos_token_id");
    |             ^^^ help: if this is intentional, prefix it with an underscore: `_eos`

warning: unused variable: `path`
   --> crates/bitnet-tokenizers/src/gguf_tokenizer.rs:102:23
    |
102 | fn read_gguf_metadata(path: &Path) -> Result<HashMap<String, serde_json::Value>> {
    |                       ^^^^ help: if this is intentional, prefix it with an underscore: `_path`

warning: unused variable: `metadata`
   --> crates/bitnet-tokenizers/src/gguf_tokenizer.rs:112:18
    |
112 | fn extract_vocab(metadata: &HashMap<String, serde_json::Value>) -> Result<HashMap<String, u32>> {
    |                  ^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_metadata`

warning: field `pad_token_id` is never read
  --> crates/bitnet-tokenizers/src/lib.rs:85:5
   |
82 | pub struct BasicTokenizer {
   |            -------------- field in this struct
...
85 |     pad_token_id: Option<u32>,
   |     ^^^^^^^^^^^^
   |
   = note: `#[warn(dead_code)]` on by default

warning: variant `Llama` is never constructed
  --> crates/bitnet-tokenizers/src/universal.rs:17:5
   |
14 | enum TokenizerBackend {
   |      ---------------- variant in this enum
...
17 |     Llama(LlamaTokenizer),
   |     ^^^^^

warning: fields `vocab` and `merges` are never read
   --> crates/bitnet-tokenizers/src/universal.rs:135:5
    |
134 | struct Gpt2Tokenizer {
    |        ------------- fields in this struct
135 |     vocab: HashMap<String, u32>,
    |     ^^^^^
136 |     merges: Vec<(String, String)>,
    |     ^^^^^^

warning: associated function `new` is never used
   --> crates/bitnet-tokenizers/src/universal.rs:206:8
    |
205 | impl LlamaTokenizer {
    | ------------------- associated function in this implementation
206 |     fn new(config: &TokenizerConfig) -> Result<Self> {
    |        ^^^

warning: `bitnet-tokenizers` (lib) generated 17 warnings
   Compiling bitnet-inference v0.1.0 (/home/steven/code/Rust/BitNet-rs/crates/bitnet-inference)
   Compiling bitnet-compat v0.1.0 (/home/steven/code/Rust/BitNet-rs/crates/bitnet-compat)
   Compiling bitnet-wasm v0.1.0 (/home/steven/code/Rust/BitNet-rs/crates/bitnet-wasm)
warning: `bitnet-common` (test "integration_tests") generated 4 warnings
   Compiling bitnet-cli v0.1.0 (/home/steven/code/Rust/BitNet-rs/crates/bitnet-cli)
error[E0308]: mismatched types
   --> crates/bitnet-inference/src/engine.rs:224:27
    |
224 |                 if step < config.logits_tap_steps {
    |                    ----   ^^^^^^^^^^^^^^^^^^^^^^^ expected `u32`, found `usize`
    |                    |
    |                    expected because this is `u32`
    |
help: you can convert a `usize` to a `u32` and panic if the converted value doesn't fit
    |
224 |                 if step < config.logits_tap_steps.try_into().unwrap() {
    |                                                  ++++++++++++++++++++

error[E0308]: mismatched types
   --> crates/bitnet-inference/src/engine.rs:246:26
    |
246 |                     (cb)(step, topk, next_token);
    |                     ---- ^^^^ expected `usize`, found `u32`
    |                     |
    |                     arguments to this function are incorrect
    |
help: you can convert a `u32` to a `usize` and panic if the converted value doesn't fit
    |
246 |                     (cb)(step.try_into().unwrap(), topk, next_token);
    |                              ++++++++++++++++++++

warning: unused variable: `tokens1`
  --> crates/bitnet-tokenizers/tests/tokenizer_contracts.rs:34:9
   |
34 |     let tokens1 = tokenizer.encode("test", false, false).expect("Should tokenize");
   |         ^^^^^^^ help: if this is intentional, prefix it with an underscore: `_tokens1`
   |
   = note: `#[warn(unused_variables)]` on by default

warning: unused variable: `tokens2`
  --> crates/bitnet-tokenizers/tests/tokenizer_contracts.rs:35:9
   |
35 |     let tokens2 = tokenizer.encode(" test", false, false).expect("Should tokenize");
   |         ^^^^^^^ help: if this is intentional, prefix it with an underscore: `_tokens2`

warning: unused variable: `expected_backend`
   --> crates/bitnet-tokenizers/tests/tokenizer_contracts.rs:133:22
    |
133 |     for (model_type, expected_backend) in test_cases {
    |                      ^^^^^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_expected_backend`

error[E0277]: `(dyn Fn(usize, Vec<(u32, f32)>, u32) + std::marker::Send + Sync + 'static)` doesn't implement `std::fmt::Debug`
  --> crates/bitnet-inference/src/config.rs:63:5
   |
36 | #[derive(Debug, Clone, Serialize, Deserialize)]
   |          ----- in this derive macro expansion
...
63 |     pub logits_cb: Option<Arc<dyn Fn(usize, Vec<(u32, f32)>, u32) + Send + Sync>>,
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ the trait `std::fmt::Debug` is not implemented for `(dyn Fn(usize, Vec<(u32, f32)>, u32) + std::marker::Send + Sync + 'static)`

Some errors have detailed explanations: E0277, E0308.
For more information about an error, try `rustc --explain E0277`.
error: could not compile `bitnet-inference` (lib) due to 3 previous errors
warning: build failed, waiting for other jobs to finish...
warning: constant `EXIT_NLL_TOO_HIGH` is never used
  --> crates/bitnet-cli/src/exit.rs:10:11
   |
10 | pub const EXIT_NLL_TOO_HIGH: i32 = 5;
   |           ^^^^^^^^^^^^^^^^^
   |
   = note: `#[warn(dead_code)]` on by default

warning: constant `EXIT_TAU_TOO_LOW` is never used
  --> crates/bitnet-cli/src/exit.rs:11:11
   |
11 | pub const EXIT_TAU_TOO_LOW: i32 = 6;
   |           ^^^^^^^^^^^^^^^^

error: could not compile `bitnet-inference` (lib test) due to 3 previous errors
warning: `bitnet-tokenizers` (test "tokenizer_contracts") generated 3 warnings
warning: `bitnet-cli` (bin "bitnet") generated 2 warnings
