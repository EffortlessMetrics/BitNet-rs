[alias]
# Xtask runner
xtask = "run -p xtask --"

# Coverage collection aliases
cov = "tarpaulin --workspace --no-default-features --features cpu --exclude bitnet-sys --exclude crossval --exclude xtask --exclude bitnet-cli --timeout 600 --out Xml --out Lcov --output-dir target/coverage"
cov-all = "tarpaulin --workspace --no-default-features --features cpu --exclude bitnet-sys --exclude crossval --exclude xtask --exclude bitnet-cli --timeout 600 --out Xml --out Lcov --out Html --output-dir target/coverage"
cov-html = "tarpaulin --workspace --no-default-features --features cpu --exclude bitnet-sys --exclude crossval --exclude xtask --exclude bitnet-cli --timeout 600 --out Html --output-dir target/coverage"

# Testing aliases
test-all = "test --workspace"
test-integration = "test --workspace --test '*'"
test-unit = "test --workspace --lib --bins"
tw = "test --workspace --no-default-features --features cpu"
gpu-tests = "test --workspace --no-default-features --features gpu"
cpu-tests = "test --workspace --no-default-features --features cpu"

# Concurrency-capped test aliases
t2 = "test --workspace --no-default-features --features cpu -- --test-threads=2"
t1 = "test --workspace --no-default-features --features cpu -- --test-threads=1"
crossval-capped = "test --workspace --features \"cpu,ffi,crossval\" -- --test-threads=2"

# Reporting aliases
report-demo = "run -p bitnet-tests --bin demo_reporting_comprehensive"
report-example = "run -p bitnet-tests --example reporting_example"
demo-sys = "run -p bitnet-tests --bin demo_reporting_system --features reporting"
demo-all = "run -p bitnet-tests --bin demo_reporting_comprehensive --features reporting"

# GPU development aliases
gpu-capped = "test --workspace --no-default-features --features gpu -- --test-threads=2"

# GPU test aliases
gpu-smoke = "test --package bitnet-kernels --test gpu_smoke --no-default-features --features gpu"
gpu-parity = "test --package bitnet-kernels --test gpu_parity --no-default-features --features gpu"
gpu-build = "build --workspace --no-default-features --features gpu"

# Development quality check aliases
check-all = "fmt --all && clippy -p bitnet-cli --all-targets -- -D warnings && clippy -p bitnet-server --all-targets -- -D warnings && test -p bitnet-server --all-targets && test -p bitnet-server --all-targets --features degraded-ok"
contracts = "public-api -p bitnet-common"

[target.wasm32-unknown-unknown]
# Select the JS/WebCrypto backend for getrandom 0.3
rustflags = ['--cfg', 'getrandom_backend="wasm_js"']
