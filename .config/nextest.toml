# cargo-nextest configuration
# https://nexte.st/book/configuration

[profile.default]
# Test execution settings
fail-fast = true
test-threads = "num-cpus"
retries = 0  # No flaky test retries - fail immediately

# Global test timeout: 5 minutes to prevent hangs
slow-timeout = { period = "300s", terminate-after = 1 }

# Output settings
failure-output = "immediate"  # Show failures immediately
success-output = "never"       # Reduce noise, never show success output
status-level = "pass"

# JUnit output for local reporting
[profile.default.junit]
path = "target/nextest/junit.xml"

[profile.default-miri]
slow-timeout = "10m"

[profile.ci]
# CI-specific settings
fail-fast = false
test-threads = 4  # Fixed thread count for reproducibility
retries = 0       # No retries in CI - tests must pass consistently

# Global test timeout: 5 minutes to prevent CI hangs
slow-timeout = { period = "300s", terminate-after = 1 }

# Output for CI
failure-output = "immediate"
success-output = "never"  # Keep CI logs clean
status-level = "fail"

# JUnit output for CI reporting
[profile.ci.junit]
path = "target/nextest/ci/junit.xml"
