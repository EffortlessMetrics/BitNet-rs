# Lefthook configuration for Git hooks
# https://github.com/evilmartians/lefthook

pre-commit:
  parallel: true
  commands:
    fmt:
      run: "cargo fmt --all -- --check"
      tags: [rust, format]
    clippy:
      run: 'RUSTFLAGS="-Dwarnings" cargo clippy --workspace --all-features --all-targets -- -D warnings -D clippy::ptr_arg'
      tags: [rust, lint]
    taplo:
      run: "taplo format --check"
      tags: [toml, format]
    banned-patterns:
      run: "bash scripts/hooks/banned-patterns.sh"
      tags: [rust, api]

pre-push:
  parallel: false
  commands:
    check-tests:
      run: 'RUSTFLAGS="-Dwarnings" cargo check --workspace --tests'
      tags: [rust, test]
    cargo-deny:
      run: "cargo deny check --hide-inclusion-graph"
      tags: [security, deps]