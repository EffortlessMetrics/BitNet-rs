# Default values for bitnet-rs
# This is a YAML-formatted file for the primary Rust implementation.
# For legacy C++ deployment options, see the 'legacy' section below.

# Global configuration
global:
  imageRegistry: ""
  imagePullSecrets: []
  storageClass: ""
  # Primary implementation - always Rust for production
  implementation: rust

# Image configuration - Rust implementation
image:
  registry: docker.io
  repository: bitnet/bitnet-rust
  tag: "1.0.0"
  pullPolicy: IfNotPresent

# Service account
serviceAccount:
  create: true
  annotations: {}
  name: ""

# Pod security context
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1000
  fsGroup: 1000

# Container security context
securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 1000

# CPU deployment configuration
cpu:
  enabled: true
  replicaCount: 3
  image:
    variant: cpu
  resources:
    limits:
      cpu: 4000m
      memory: 8Gi
    requests:
      cpu: 1000m
      memory: 2Gi
  nodeSelector:
    kubernetes.io/arch: amd64
  tolerations: []
  affinity: {}

  # Autoscaling
  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80

# GPU deployment configuration
gpu:
  enabled: false
  replicaCount: 2
  image:
    variant: gpu
  resources:
    limits:
      cpu: 8000m
      memory: 16Gi
      nvidia.com/gpu: 1
    requests:
      cpu: 2000m
      memory: 4Gi
      nvidia.com/gpu: 1
  nodeSelector:
    accelerator: nvidia-tesla-v100
  tolerations:
    - key: "nvidia.com/gpu"
      operator: "Exists"
      effect: "NoSchedule"
  affinity: {}

  # Autoscaling
  autoscaling:
    enabled: true
    minReplicas: 1
    maxReplicas: 5
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70

# Service configuration
service:
  type: ClusterIP
  port: 8080
  metricsPort: 9090
  annotations: {}

# Ingress configuration
ingress:
  enabled: false
  className: "nginx"
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-body-size: "100m"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "300"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "300"
  hosts:
    - host: bitnet.local
      paths:
        - path: /
          pathType: Prefix
  tls: []

# Persistent storage
persistence:
  models:
    enabled: true
    storageClass: ""
    accessMode: ReadOnlyMany
    size: 100Gi
    annotations: {}
  cache:
    enabled: true
    storageClass: ""
    accessMode: ReadWriteMany
    size: 50Gi
    annotations: {}

# Configuration
config:
  model:
    path: "/app/models"
    format: "auto"
  inference:
    max_tokens: 2048
    temperature: 0.7
    top_k: 50
    top_p: 0.9
  server:
    host: "0.0.0.0"
    port: 8080
    workers: 4
  monitoring:
    metrics_enabled: true
    metrics_port: 9090
    health_check_enabled: true
  logging:
    level: "info"
    format: "json"

# Environment variables
env: []

# Health checks
healthCheck:
  enabled: true
  path: /health
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

readinessCheck:
  enabled: true
  path: /ready
  initialDelaySeconds: 5
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 3

startupCheck:
  enabled: true
  path: /health
  initialDelaySeconds: 10
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 30

# Monitoring
monitoring:
  serviceMonitor:
    enabled: false
    namespace: ""
    interval: 30s
    scrapeTimeout: 10s
    labels: {}
    annotations: {}

# Pod disruption budget
podDisruptionBudget:
  enabled: true
  minAvailable: 1
  maxUnavailable: ""

# Network policy
networkPolicy:
  enabled: false
  ingress: []
  egress: []

# RBAC
rbac:
  create: true
  rules: []

# Pod annotations and labels
podAnnotations: {}
podLabels: {}

# Node selector, tolerations, and affinity
nodeSelector: {}
tolerations: []
affinity: {}

# Extra volumes and volume mounts
extraVolumes: []
extraVolumeMounts: []

# Init containers
initContainers: []

# Sidecar containers
sidecars: []

# Legacy C++ deployment (for cross-validation and migration support only)
# WARNING: This is not recommended for production use
legacy:
  enabled: false
  replicaCount: 1
  image:
    registry: docker.io
    repository: bitnet/bitnet-cpp
    tag: "legacy-latest"
    pullPolicy: IfNotPresent
  resources:
    limits:
      cpu: 2000m
      memory: 4Gi
    requests:
      cpu: 500m
      memory: 1Gi
  nodeSelector:
    kubernetes.io/arch: amd64
  tolerations:
    - key: "bitnet.io/legacy"
      operator: "Equal"
      value: "true"
      effect: "NoSchedule"
  affinity: {}

  # Legacy-specific configuration
  config:
    legacy_mode: true
    cross_validation: true

  # Service configuration for legacy
  service:
    enabled: false  # Disabled by default
    type: ClusterIP
    port: 8080
    annotations:
      description: "Legacy C++ service - use Rust services for production"
